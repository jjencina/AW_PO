<!DOCTYPE html>
<html lang="es">
<head>
    <title>Instalaciones UCM</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link rel='stylesheet' href='/stylesheets/reserva.css' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>
    <%- include("header") %>     
    <div class="container compensacion-lateral" id="ctn-carrusel">
        <div class="row">
        <!--La primera columna es el carrusel de imagenes-->
            <div class="col-md-8">
                <div class="container">
                    <div id="imagenCarousel" class="carousel slide" data-bs-ride="carousel">
                    <!--Las imagenes del carrusel-->
                    <div class="carousel-inner">                  
                        <div class="carousel-item active">
                            <img src="/img/<%= imagenes[0].nombre_imagen %>" class="card img-fluid mx-auto" alt="<%=imagenes[0].nombre_imagen%>">
                        </div>                
                    </div>
                    <!--Botones de control del carrusel-->
                    <a class="carousel-control-prev" href="#imagenCarousel" role="button" data-bs-slide="prev" style="width: 10%;">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>                
                    </a>
                    <a class="carousel-control-next" href="#imagenCarousel" role="button" data-bs-slide="next" style="width: 10%;">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>                    
                    </a>
                    </div>
                </div>
            </div>
            <!--La segunda columna es la descripción del destino-->
            <div class="col-md-4">
                <div class="container" id="descripcionDestino">
                    <!--Botón mostrar-->
                    <input type="checkbox" id="mostrarFormulario" class="d-none">
                    <label for="mostrarFormulario" class="btn btn-primary">Reserva ya</label>
        
                    <!-- Formulario de reserva -->
                    <form id="reservaForm" action='/reservar' method="post" class="d-none">                  
                        <!-- Campos existentes -->
                        <div class="form-group">
                            <label for="nombre_usuario">Nombre del cliente:</label>
                            <input type="text" class="form-control" id="nombre_cliente" name="nombre_cliente" required autocomplete="nombre_cliente" value="<%= FormData.nombre_cliente || '' %>">
                        </div>
                        <div class="form-group">
                            <label for="email">Correo electrónico:</label>
                            <input type="email" class="form-control" id="email" name="email" required autocomplete="email" value="<%= FormData.email || '' %>">
                        </div>
                        <div class="form-group">
                            <label for="fechaReserva">Fecha de reserva:</label>
                            <input type="date" class="form-control" id="fechaReserva" name="fechaReserva" required autocomplete="off" %>">
                        </div>
                        
                        <!-- Botón "Aceptar" -->
                        <button type="submit" class="btn btn-primary">Aceptar</button>
                        
                        <!-- Mostrar mensaje de éxito -->
                        <% if (reservaExitosa) { %>
                        <div class="alert alert-success" role="alert">
                            Reserva exitosa. ¡Gracias!
                        </div>
                        <% } %>                        
                        <!-- Mostrar mensajes de error -->
                        <% if (errors && errors.length > 0) { %>
                        <div class="alert alert-danger" role="alert">
                            <ul>
                            <% errors.forEach(error => { %>
                                <li><%= error.msg %></li>
                            <% }); %>
                            </ul>
                        </div>
                        <% } %>        
                    </form>        
                </div>
            </div>
        </div>
    </div>
    
    <!--Funcionamiento del boton mostrar-->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
        var mostrarFormularioBtn = document.getElementById('mostrarFormulario');
        var reservaForm = document.getElementById('reservaForm');
        
        // Verifica el estado del checkbox al cargar la página
        if (mostrarFormularioBtn.checked) {
            reservaForm.classList.remove('d-none');
        } else {
            reservaForm.classList.add('d-none');
        }
        
        mostrarFormularioBtn.addEventListener('change', function () {
            // Mostrar el formulario al marcar el checkbox
            if (mostrarFormularioBtn.checked) {
            reservaForm.classList.remove('d-none');
            } else {
            reservaForm.classList.add('d-none');
            }
        });
        
        // Verifica si hay errores o éxito al cargar la página y muestra el formulario si es necesario
        var errorsExist = document.querySelector('.alert-danger');
        var successExist = document.querySelector('.alert-success');
        
        if (errorsExist || successExist) {
            mostrarFormularioBtn.checked = true;
            reservaForm.classList.remove('d-none');
        }
        });
    </script>
   
    <%- include("footer") %>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
    
   